<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>> FEAR_GREED_PROTOCOL <</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Courier New', monospace; background: #0a0a0a; color: #fff; min-height: 100vh; overflow-x: hidden; position: relative; }
        #particles-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0.3; }
        .container { text-align: center; max-width: 900px; width: 100%; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }
        .controls { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 100; }
        .control-btn { background: rgba(0, 255, 0, 0.2); border: 2px solid #00ff00; color: #00ff00; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-family: 'Courier New', monospace; font-size: 0.9em; transition: all 0.3s ease; }
        .control-btn:hover { background: rgba(0, 255, 0, 0.4); transform: scale(1.05); }
        .control-btn.active { background: #00ff00; color: #000; }
        .btc-ticker { background: linear-gradient(135deg, #f7931a 0%, #ffb74d 100%); padding: 15px 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 5px 20px rgba(247, 147, 26, 0.3); animation: pulse 2s ease-in-out infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); box-shadow: 0 5px 20px rgba(247, 147, 26, 0.3); } 50% { transform: scale(1.02); box-shadow: 0 8px 30px rgba(247, 147, 26, 0.5); } }
        .btc-label { font-size: 0.9em; color: #000; opacity: 0.8; text-transform: uppercase; letter-spacing: 2px; font-weight: bold; }
        .btc-price { font-size: 2.5em; font-weight: bold; color: #000; margin: 5px 0; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .btc-change { font-size: 1.2em; font-weight: bold; margin-top: 5px; }
        .positive { color: #00ff00; }
        .negative { color: #ff0000; }
        .title { font-size: 2.2em; color: #00ff00; margin-bottom: 25px; font-weight: bold; letter-spacing: 3px; text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00; animation: terminal-flicker 3s ease-in-out infinite; }
        @keyframes terminal-flicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.95; } }
        .gauge { width: 400px; height: 400px; margin: 30px auto; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255,255,255,0.05); border-radius: 50%; border: 4px solid rgba(255,255,255,0.2); transition: all 0.5s ease; box-shadow: 0 0 30px rgba(0,0,0,0.5); padding: 40px; }
        .gauge.extreme { animation: extreme-pulse 1s ease-in-out infinite; }
        @keyframes extreme-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .score { font-size: 5.5em; font-weight: bold; text-shadow: 0 0 30px currentColor; margin-bottom: 10px; }
        .status { font-size: 1.1em; margin-top: 15px; letter-spacing: 2px; font-weight: bold; text-transform: uppercase; line-height: 1.3; }
        .degen { font-size: 3em; font-family: 'Comic Sans MS', cursive, sans-serif; color: #fff; margin: 30px; font-weight: bold; text-shadow: 0 0 20px currentColor; animation: degen-bounce 2s ease-in-out infinite; }
        @keyframes degen-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .chart-container { background: rgba(255,255,255,0.05); border: 2px solid rgba(0, 255, 0, 0.3); border-radius: 15px; padding: 30px; margin: 40px 0; box-shadow: 0 0 20px rgba(0, 255, 0, 0.1); }
        .chart-title { color: #00ff00; font-size: 1.3em; margin-bottom: 20px; letter-spacing: 2px; text-transform: uppercase; }
        .btn { background: linear-gradient(135deg, #00ff00, #00cc00); border: 2px solid #00ff00; color: #000; padding: 15px 40px; font-size: 1.1em; border-radius: 5px; cursor: pointer; font-family: 'Courier New', monospace; font-weight: bold; margin: 10px; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 0 15px rgba(0, 255, 0, 0.3); transition: all 0.3s ease; }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 25px rgba(0, 255, 0, 0.6); }
        .share-btn { background: linear-gradient(135deg, #1DA1F2, #0d8bd9); border-color: #1DA1F2; }
        .share-btn:hover { box-shadow: 0 0 25px rgba(29, 161, 242, 0.6); }
        @media (max-width: 768px) { .title { font-size: 1.5em; } .degen { font-size: 2em; } .btc-price { font-size: 2em; } .gauge { width: 300px; height: 300px; padding: 30px; } .score { font-size: 4em; } .status { font-size: 0.9em; } .controls { top: 10px; right: 10px; flex-direction: column; } .chart-container { padding: 15px; } }
    </style>
</head>
<body>
    <canvas id="particles-canvas"></canvas>
    <div class="controls">
        <button class="control-btn active" id="soundToggle" title="Toggle Sound">üîä</button>
        <button class="control-btn active" id="particlesToggle" title="Toggle Particles">‚ú®</button>
        <button class="control-btn" id="notifyToggle" title="Enable Notifications">üîî</button>
    </div>
    <div class="container">
        <div class="btc-ticker"><div class="btc-label">‚Çø Bitcoin</div><div class="btc-price" id="btcPrice">Loading...</div><div class="btc-change" id="btcChange"></div></div>
        <div class="title">&gt; FEAR_GREED_PROTOCOL &lt;</div>
        <div id="content">Loading...</div>
        <div class="chart-container"><div class="chart-title">üìä 30-Day Sentiment History</div><canvas id="historyChart"></canvas></div>
        <button class="btn share-btn" onclick="shareToTwitter()">üê¶ SHARE TO TWITTER</button>
    </div>
    <script>
        let currentScore=0,soundEnabled=true,particlesEnabled=true,notificationsEnabled=false,lastNotificationScore=null;
        const canvas=document.getElementById('particles-canvas'),ctx=canvas.getContext('2d');
        canvas.width=window.innerWidth;canvas.height=window.innerHeight;
        const particles=[];
        class Particle{constructor(){this.x=Math.random()*canvas.width;this.y=Math.random()*canvas.height;this.vx=(Math.random()-0.5)*0.5;this.vy=(Math.random()-0.5)*0.5;this.radius=Math.random()*2+1;}update(){this.x+=this.vx;this.y+=this.vy;if(this.x<0||this.x>canvas.width)this.vx*=-1;if(this.y<0||this.y>canvas.height)this.vy*=-1;}draw(){ctx.fillStyle=getColorForScore(currentScore);ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();}}
        for(let i=0;i<50;i++)particles.push(new Particle());
        function animateParticles(){if(particlesEnabled){ctx.clearRect(0,0,canvas.width,canvas.height);particles.forEach(p=>{p.update();p.draw();});}requestAnimationFrame(animateParticles);}
        animateParticles();
        window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});
        function getColorForScore(s){return s<20?'#ff4444':s<40?'#ff8844':s<60?'#ffd700':s<80?'#88ff44':'#44ff88';}
        document.getElementById('soundToggle').addEventListener('click',function(){soundEnabled=!soundEnabled;this.classList.toggle('active');this.textContent=soundEnabled?'üîä':'üîá';});
        document.getElementById('particlesToggle').addEventListener('click',function(){particlesEnabled=!particlesEnabled;this.classList.toggle('active');this.textContent=particlesEnabled?'‚ú®':'‚ö´';});
        document.getElementById('notifyToggle').addEventListener('click',async function(){if(!notificationsEnabled&&'Notification'in window){const p=await Notification.requestPermission();if(p==='granted'){notificationsEnabled=true;this.classList.add('active');new Notification('üîî Notifications Enabled!');}}else{notificationsEnabled=false;this.classList.remove('active');}});
        async function fetchBTCPrice(){try{const r=await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true');const d=await r.json();const p=d.bitcoin.usd,c=d.bitcoin.usd_24h_change;document.getElementById('btcPrice').textContent='$'+p.toLocaleString('en-US',{maximumFractionDigits:0});const e=document.getElementById('btcChange');e.textContent=(c>0?'+':'')+c.toFixed(2)+'% (24h)';e.className='btc-change '+(c>0?'positive':'negative');}catch(e){}}
        async function fetchHistoricalData(){try{const r=await fetch('/api/fgi?history=true');const d=await r.json();if(d.history)renderChart(d.history);}catch(e){}}
        function renderChart(h){const c=document.getElementById('historyChart').getContext('2d');new Chart(c,{type:'line',data:{labels:h.map(d=>d.date),datasets:[{label:'Fear & Greed Score',data:h.map(d=>d.score),borderColor:'#00ff00',backgroundColor:'rgba(0,255,0,0.1)',tension:0.4,fill:true,pointBackgroundColor:h.map(d=>getColorForScore(d.score)),pointBorderColor:'#fff',pointBorderWidth:2,pointRadius:4}]},options:{responsive:true,plugins:{legend:{labels:{color:'#00ff00',font:{family:'Courier New'}}}},scales:{y:{beginAtZero:true,max:100,grid:{color:'rgba(0,255,0,0.1)'},ticks:{color:'#00ff00'}},x:{grid:{color:'rgba(0,255,0,0.1)'},ticks:{color:'#00ff00',maxRotation:45,minRotation:45}}}}});}
        async function fetchData(){try{const r=await fetch('/api/fgi');const d=await r.json();currentScore=d.meta_score;const c=getColorForScore(currentScore);const e=currentScore<=20||currentScore>=80;if(e&&notificationsEnabled&&(lastNotificationScore===null||Math.abs(lastNotificationScore-currentScore)>10)){new Notification(currentScore<=20?'üî• EXTREME FEAR!':'‚ö†Ô∏è EXTREME GREED!',{body:'Score: '+currentScore});lastNotificationScore=currentScore;}else if(!e){lastNotificationScore=null;}document.getElementById('content').innerHTML='<div class="gauge '+(e?'extreme':'')+'" style="border-color:'+c+';"><div class="score" style="color:'+c+'">'+d.meta_score+'</div><div class="status" style="color:'+c+'">'+d.status+'</div></div><div class="degen" style="color:'+c+'">'+d.degen_status+'</div><button class="btn" onclick="refreshAll()">[  REFRESH  ]</button><div style="color:#00ff00;font-size:0.8em;opacity:0.6;">> '+new Date(d.timestamp).toLocaleTimeString()+'</div>';}catch(e){document.getElementById('content').innerHTML='<div style="color:#ff6b6b;">ERROR: '+e.message+'</div>';}}
        function shareToTwitter(){const s=currentScore<20?'BLOOD IN THE STREETS':currentScore<40?'PAPER HANDS EVERYWHERE':currentScore<60?'CRAB MARKET':currentScore<80?'FOMO KICKING IN':'EUPHORIA - TOP IS IN';const e=currentScore<20?'üî•':currentScore<40?'üíé':currentScore<60?'ü¶Ä':currentScore<80?'üöÄ':'‚ö†Ô∏è';const t=e+' Crypto Fear & Greed: '+currentScore+'/100\n\nStatus: '+s+'\n\nCheck it live:';window.open('https://twitter.com/intent/tweet?text='+encodeURIComponent(t)+'&url='+encodeURIComponent(window.location.href),'_blank','width=550,height=420');}
        function refreshAll(){fetchData();fetchBTCPrice();fetchHistoricalData();}
        fetchData();fetchBTCPrice();fetchHistoricalData();
        setInterval(fetchBTCPrice,30000);setInterval(fetchData,60000);
    </script>
</body>
</html>